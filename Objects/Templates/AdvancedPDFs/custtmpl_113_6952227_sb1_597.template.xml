<?xml version="1.0"?>
<!DOCTYPE pdf PUBLIC "-//big.faceless.org//report" "report-1.1.dtd">
<pdf>
    <head>
        <link name="NotoSans" type="font" subtype="truetype" src="${nsfont.NotoSans_Regular}"
              src-bold="${nsfont.NotoSans_Bold}" src-italic="${nsfont.NotoSans_Italic}"
              src-bolditalic="${nsfont.NotoSans_BoldItalic}" bytes="2"/>
        <#if .locale=="zh_CN">
        <link name="NotoSansCJKsc" type="font" subtype="opentype" src="${nsfont.NotoSansCJKsc_Regular}"
              src-bold="${nsfont.NotoSansCJKsc_Bold}" bytes="2"/>
        <#elseif .locale=="zh_TW">
        <link name="NotoSansCJKtc" type="font" subtype="opentype" src="${nsfont.NotoSansCJKtc_Regular}"
              src-bold="${nsfont.NotoSansCJKtc_Bold}" bytes="2"/>
        <#elseif .locale=="ja_JP">
        <link name="NotoSansCJKjp" type="font" subtype="opentype" src="${nsfont.NotoSansCJKjp_Regular}"
              src-bold="${nsfont.NotoSansCJKjp_Bold}" bytes="2"/>
        <#elseif .locale=="ko_KR">
        <link name="NotoSansCJKkr" type="font" subtype="opentype" src="${nsfont.NotoSansCJKkr_Regular}"
              src-bold="${nsfont.NotoSansCJKkr_Bold}" bytes="2"/>
        <#elseif .locale=="th_TH">
        <link name="NotoSansThai" type="font" subtype="opentype" src="${nsfont.NotoSansThai_Regular}"
              src-bold="${nsfont.NotoSansThai_Bold}" bytes="2"/>
    </#if>
    <macrolist>
        <macro id="nlheader">
            <table border="0" style="border-collapse: collapse; width: 100%;display: block;">
                <tr>
                    <td colspan="3" style="width: 37.5%;">
                        <img height="50%"
                             src="https://6952227-sb1.app.netsuite.com/core/media/media.nl?id=11&amp;c=6952227_SB1&amp;h=_yJMy7DSQDrilIpPJK1nQb_qIKA-jOoUGXsfiVQpE8KqWzPi"
                             style="float: center;" width="50%"/>
                    </td>
                    <td align="center" colspan="2" style="width: auto;">
                        <p style="text-align: center;">PO Box 69<br/>5655 Hwy 12 W<br/>Maple Plain MN 55359<br/>Toll
                            Free: 800-362-3500<br/>Phone: 763-479-2501<br/>Fax: 763-479-1061
                        </p>
                    </td>
                    <td colspan="3" style="width: 37.5%;" align="center">
                        <img height="50%"
                             src="https://6952227-sb1.app.netsuite.com/core/media/media.nl?id=2094&amp;c=6952227_SB1&amp;h=Lfa0Rnma72l3wnBJKTQn1INzXINYQkisNCdBRUGTv7yjgnKZ"
                             style="float: center; width: 50%;"/>
                    </td>
                </tr>
                <tr>
                    <td colspan="3" style="width: 37.5%;">&nbsp;</td>
                    <td align="center" colspan="2" style="width: auto;">&nbsp;</td>
                    <td colspan="3" style="width: 37.5%;">&nbsp;</td>
                </tr>
                <tr>
                    <td colspan="3" style="width: 37.5%;">&nbsp;</td>
                    <td align="center" colspan="2" style="width: auto;">&nbsp;</td>
                    <td colspan="3" style="width: 37.5%;">&nbsp;</td>
                </tr>
                <tr>
                    <td style="width: 12.5%;">&nbsp;</td>
                    <td colspan="2" style="width: 25%; align: center;">
                        <p>Des Moines IA<br/>515-964-9273
                        </p>
                    </td>
                    <td colspan="2" style="width: 25%; align: center;">www.herculift.com</td>
                    <td colspan="2" style="width: 25%; align: center;">
                        <p>Sioux Falls SD<br/>605-332-4755
                        </p>
                    </td>
                    <td style="width: 12.5%;">&nbsp;</td>
                </tr>
                <tr>
                    <td align="center" style="width: 12.5%;">Maple Plain MN<br/>763-479-2501
                    </td>
                    <td align="center" style="width: 12.5%;">Grand Rapids MN<br/>218-326-0539
                    </td>
                    <td align="center" style="width: 12.5%;">St. Cloud MN<br/>320-251-9001
                    </td>
                    <td align="center" style="width: 12.5%;">Fargo ND<br/>701-219-5811
                    </td>
                    <td align="center" style="width: 12.5%;">Minot ND<br/>701-839-5820
                    </td>
                    <td align="center" style="width: 12.5%;">Williston ND<br/>701-572-4660
                    </td>
                    <td align="center" style="width: 12.5%;">Boscobel WI<br/>888-244-6802
                    </td>
                    <td align="center" style="width: 12.5%;">Milwaukee WI<br/>262-785-9890
                    </td>
                </tr>
            </table>
        <table border="0" style="border-collapse: collapse; width: 100%;">
          <tr>
            <td colspan="3" style="width: 25%;">&nbsp;</td>
            <td colspan="3" style="width: 50%;">&nbsp;</td>
            <td colspan="3" style="width: 25%;">&nbsp;</td>
          </tr>
          <tr>
            <td colspan="3" style="width: 25%;">
              <p style="text-align: left;">Date:&nbsp;&nbsp;${record.trandate}</p>
            </td>
            <td align="center" colspan="3" style="width: 50%;">
              <p style="text-align: center;font-size: 14px;">
                <b>Work Order Estimate</b>
              </p>
            </td>
            <td colspan="3" style="width: 25%;">
              <p style="text-align: left;">Order No:&nbsp;&nbsp;${record.tranid} <br />Page:&nbsp;&nbsp;
                <pagenumber />
              </p>
            </td>
          </tr>
          <tr>
            <td align="left" colspan="3" style="width: 25%;">&nbsp;</td>
            <td colspan="3" style="width: 50%;">&nbsp;</td>
            <td colspan="3" style="width: 25%;">&nbsp;</td>
          </tr>
        </table>
        <table border="0" style="border-collapse: collapse; width: 100%;">
          <tr>
            <td style="width: 30%;">&nbsp;</td>
            <td colspan="3" style="width: 30%;">&nbsp;</td>
            <td style="width: 40%;">&nbsp;</td>
          </tr>
          <tr>
            <td align="left" style="width: 30%;">Estimate prepared for:<br/> ${record.billaddress} </td>
            <td colspan="3" style="width: 30%;">&nbsp;</td>
            <td align="left" style="width: 40%;">Ship To: ${record.shipaddress}</td>
          </tr>
          <tr>
            <td style="width: 30%;">&nbsp;</td>
            <td colspan="3" style="width: 30%;">&nbsp;</td>
            <td style="width: 40%;">&nbsp;</td>
          </tr>
        </table>
        <table border="0" style="border-collapse: collapse; width: 100%;">
          <tr>
            <td align="left" style="width: 30%;">Customer PO No. : ${record.otherrefnum}</td>
            <td colspan="3" style="width: 30%;">&nbsp;</td>
            <td align="left" style="width: 40%;">Payment Terms : ${record.terms}</td>
          </tr>
          <tr>
            <td align="left" style="width: 30%;">Contact : ${record.custbody_sna_contact.entityid}</td>
            <td colspan="3" style="width: 30%;">&nbsp;</td>
            <td align="left" style="width: 40%;">Branch : ${record.location}</td>
          </tr>
          <tr>
            <td align="left" style="width: 30%;">Phone No. : ${record.custbody_sna_contact.phone}</td>
            <td colspan="3" style="width: 30%;">&nbsp;</td>
            <td align="left" style="width: 40%;">Ship Method : ${record.shipcarrier}</td>
          </tr>
          <tr>
            <td align="left" style="width: 30%;">&nbsp;</td>
            <td colspan="3" style="width: 30%;">&nbsp;</td>
            <td align="left" style="width: 40%;">Salesperson : ${record.custbody_sna_order_taken_by}</td>
          </tr>
          <tr>
            <td style="width: 30%;">&nbsp;</td>
            <td colspan="3" style="width: 30%;">&nbsp;</td>
            <td style="width: 40%;">&nbsp;</td>
          </tr>
        </table>
        <table style="width: 100%; margin-bottom: 10px">
          <tr>
            <td align="left" style="width: 30%;border-top: 1px solid #000;">&nbsp;&nbsp;</td>
            <td colspan="3" style="width: 30%;border-top: 1px solid #000;">&nbsp;&nbsp;</td>
            <td align="left" style="width: 40%;border-top: 1px solid #000;">&nbsp;&nbsp;</td>
          </tr>
          <tr>
             <td align="left" style="width: 50%;">Site Asset: ${record.custbody_nx_asset}</td>
             <td align="left" style="width: 50%; padding-left: 170px;">Service : ${record.cseg_sna_revenue_st}</td>
          </tr>
          <!-- <tr>
            <td align="left" style="width: 50%;">Service : ${record.cseg_sna_revenue_st}</td>
            <td align="left" style="width: 50%; padding-left: 183px;">Meter Combined: ${record.custbody_meter_combined}</td>
          </tr>-->
          <tr>
            <td align="left" style="width: 50%;">Equipment Object : ${record.custbody_sna_hul_nxc_eq_asset?keep_after(":")}</td>
            <td align="left" style="width: 50%; padding-left: 170px;">Model: ${record.custbody_sna_hul_nxc_eq_asset.custrecord_sna_hul_nxc_object_model}</td>
          </tr>
          <tr>
            <td align="left" style="width: 50%;">Make : ${record.custbody_sna_mfr}</td>
            <td align="left" style="width: 50%; padding-left: 170px;">Serial No. : ${record.custbody_sna_serial_number}</td>
          </tr>
          <!-- <tr>
            <td align="left" style="width: 30%;">Model : ${record.custbody_sna_model}</td>
            <td colspan="3" style="width: 30%;">&nbsp;</td>
            <td align="left" style="width: 40%;">&nbsp;</td>
          </tr> -->
          <!-- <tr>
            <td align="left" style="width: 30%;">Serial No. : ${record.custbody_sna_serial_number}</td>
            <td colspan="3" style="width: 30%;">&nbsp;</td>
            <td align="left" style="width: 40%;">&nbsp;</td>
          </tr> -->
          <tr>
            <td align="left" style="width: 30%;">Fleet Number : ${record.custrecord_sna_fleet_code}</td>
            <td align="left" style="width: 50%;padding-left: 170px;">Meter :${record.custpage_meterreading}</td>
          </tr>
        </table>
      </macro>
      <macro id="nlfooter">
        <table border="0" id="footer">
          <tr>
            <td align="left" rowspan ="7">
            <p style="vertical-align: middle;">Your PO No. :.....................................................</p>

            <p style="vertical-align: middle; ">Estimate does not include fluids, chemicals, supplies, orde</p>
            <p> fees or freight costs. Estimate is valid for 15 days and subject to an 8% variance.</p>
            </td>
            <td align="right">Accepted By</td>
            <td align="right">: .............................................................................................</td>
          
          </tr>
          <tr>
            <td align="right">Name</td>
            <td align="right">: .............................................................................................</td>
            </tr>
            <tr>
            <td align="right">Title</td>
            <td align="right">: .............................................................................................</td>
          </tr>       
          <tr>
            <td align="right">Date</td>
            <td align="right">: .............................................................................................</td>
            </tr>
            <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
          </tr>
          <tr>
            <td align="right">Signature</td>
            <td align="right">&nbsp;&nbsp;&nbsp;___________________________________________ X</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
          </tr>
        </table>
      </macro>
    </macrolist>
    <style type="text/css">
      body {
        font-family: Open Sans, Helvetica, sans-serif;
      }

      table {
        font-size: x-small;
        width: 100%;
      }

      td {
        padding-top: 1px;
        padding-bottom: 1px;
      }
    </style>
  </head>
  <body header="nlheader" header-height="42%" footer="nlfooter" footer-height="10%" padding="0.5in 0.5in 0.5in 0.5in" size="Letter">
     <table style="width: 100%; margin-top: 10px; padding-top: 50px">
         <tr>
            <td align="left" style="width: 30%;">&nbsp;</td>
            <td colspan="3" style="width: 30%;">&nbsp;</td>
            <td align="left" style="width: 40%;">&nbsp;</td>
        </tr>
         <tr>
            <td align="left" style="width: 30%; border-top: 1px solid #000;">&nbsp;</td>
            <td colspan="3" style="width: 30%; border-top: 1px solid #000;">&nbsp;</td>
            <td align="left" style="width: 40%; border-top: 1px solid #000;">&nbsp;</td>
        </tr>
        <tr>
        <!-- <td>&nbsp;</td> -->
           <td align="left" style="width: 30%;">We are pleased to submit the following <br />cost estimate. Contact ${record.custbody_sna_order_taken_by} ${record.custbody_sna_order_taken_by.phone} <br />Email: ${record.custbody_sna_order_taken_by.email} </td>
           <td > &nbsp;</td>
           <td align="left" style="width: 40%;  white-space: pre;">
              ${record.message}
           </td>
        </tr>
     </table>
    <!-- start transaction header -->
    <!-- end transaction header -->
    <!-- start items/expenses -->
    <!-- <span class="number">${record.item@label}</span> -->
    <table style="width: 100%; margin-top: 10px; ">
      <thead>
        <tr style="font-weight: bold;">
          <th align="left" style="border-bottom: solid #000000;border-top: solid #000000;">Task Code</th>
          <th align="left" style="border-bottom: solid #000000;border-top: solid #000000;width: 300px;">Description</th>
          <th align="center" style="border-bottom: solid #000000;border-top: solid #000000"></th>
          <th align="center" style="border-bottom: solid #000000;border-top: solid #000000;"></th>
          <th align="center" style="border-bottom: solid #000000;border-top: solid #000000;"></th>
          <th align="center" style="border-bottom: solid #000000;border-top: solid #000000;">Amount</th>
        </tr>
      </thead>
      <!-- start items -->
	  <#assign internalamt = 0 />
      <#assign internaltaxamt = 0 />
	  <#assign seen_style = []>
    		<!-- <#assign totalItemAmount = 0> -->

      <#list record.item?sort_by("custcol_sna_task_code") as item>
	  <#assign groupId = item.custcol_sna_task_code>
    		 <!-- <#list record.item as item>		
      <#if item.custcol_sna_task_code == groupId >
		<#assign itemAmount = item.amount>
		<#assign totalItemAmount += itemAmount>  
    </#if>
    </#list> -->
	<#if !item.custcol_sna_do_not_print && !item.custcol_sna_default_rev_stream> 
	  <#if seen_style?seq_contains(groupId)> <#else>
     <#assign seen_style = seen_style + [groupId]>

        <tr>
          <td align="left">${item.custcol_sna_task_code}</td>
          <td align="left">${item.custcol_sna_task_description}</td>
          <td align="left"></td>
          <td align="left"></td>
          <td align="left"></td>
          <td align="left"></td>
         
    		<!-- <td align="right">${totalItemAmount?string.currency}</td> -->

        </tr>
		<#assign totalItemAmount = 0>
		<#list record.item as item>		
		<#if item.custcol_sna_task_code == groupId >
			<#if !item.custcol_sna_do_not_print && !item.custcol_sna_default_rev_stream> 
			<#assign itemAmount = item.amount>
			<#assign totalItemAmount += itemAmount> 
			</#if>
		</#if>
		</#list>		
		<tr>
		<td align="left"></td>
          <td align="left"></td>
         <td align="left"></td>
          <td align="left"></td>
          <td align="left"></td>
		<td align="right">${totalItemAmount?string.currency}</td>
		</tr>		
		</#if>	
		<#else>
			<#assign internalamt = internalamt + item.amount />
			<#assign internaltaxamt = internaltaxamt + item.custcol_ava_taxamount />
		</#if>
      </#list>
    </table>
    <table style="width: 100%;">
      <tr>
          <td align="left">&nbsp;</td>
          <td align="left">&nbsp;</td>
          <td align="center">&nbsp;</td>
          <td align="center">&nbsp;</td>
          <td align="right">&nbsp;</td>
          <td align="right">&nbsp;</td>
      </tr>
	  
	  <#assign subtotaltotalorder_= record.subtotal - internalamt>
	  <#assign taxtotalorder_= record.taxtotal - internaltaxamt>

	  <tr>
          <td align="left">&nbsp;</td>
          <td align="left">&nbsp;</td>
          <td align="center">&nbsp;</td>
          <td align="center">&nbsp;</td>
          <td align="right"><strong>Total</strong></td>
          <!-- <td align="right">${record.subtotal}</td> -->
		  <td align="right">${subtotaltotalorder_?string.currency}</td>
      </tr>
	  <tr>
          <td align="left">&nbsp;</td>
          <td align="left">&nbsp;</td>
          <td align="center">&nbsp;</td>
          <td align="center">&nbsp;</td>
          <td align="right"><strong>Tax</strong></td>
          <!-- <td align="right" style="border-bottom: solid #000000;">${record.taxtotal}</td> -->
		  <td align="right" style="border-bottom: solid #000000;">${taxtotalorder_?string.currency}</td>
      </tr>
	  <!-- <#assign totalorder_=record.subtotal + record.taxtotal> -->
	  <#assign totalorderr_= subtotaltotalorder_ + taxtotalorder_>
	  <tr>
          <td align="left">&nbsp;</td>
          <td align="left">&nbsp;</td>
          <td align="center">&nbsp;</td>
          <td align="center">&nbsp;</td>
          <td align="right"><strong>Total Amount Incl. Tax</strong></td>
          <td align="right">${totalorderr_?string.currency}</td>
      </tr>
    </table>
  </body>
</pdf>