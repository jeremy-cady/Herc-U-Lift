SELECT
  	ea.id               	AS equipment_id,
        o.id                		AS object_id,
        j.id                		AS project_id,
        t.supportcase       AS case_id,
        t.id                		AS task_id,
        t.status            	AS task_status,
	t.startdate		AS task_start_date,
	t.createddate	AS task_created_date,
	CASE 
          	WHEN NOT REGEXP_LIKE(chm.custrecord_sna_hul_actual_reading, '^[0-9.]+$') THEN NULL
              	ELSE chm.custrecord_sna_hul_actual_reading
      	END AS current_hours_reading,
     	chm.created AS current_hours_date,
       	CASE 
         	WHEN j.cseg_sna_revenue_st = 263 THEN 'PM'
               	WHEN j.cseg_sna_revenue_st = 18  THEN 'AN'
              	WHEN j.cseg_sna_revenue_st = 19  THEN 'CO'
              	ELSE 'Other'
       	END AS revenue_stream,
	'FUTURE_TASK' 	AS task_category
FROM 
     	task t
LEFT JOIN job j
    	ON j.id = t.company
LEFT JOIN customrecord_nx_asset ea
    	ON ea.id = j.custentity_hul_nxc_eqiup_asset
LEFT JOIN customrecord_sna_objects o
      	ON o.id = j.custentity_hul_nxc_equip_object
LEFT JOIN customrecord_sna_hul_hour_meter chm
      	ON  j.custentity_hul_nxc_equip_object = chm.custrecord_sna_hul_object_ref
       	AND chm.created = (
             	SELECT MAX(chm2.created)
               	FROM customrecord_sna_hul_hour_meter chm2
              	WHERE chm2.custrecord_sna_hul_object_ref = j.custentity_hul_nxc_equip_object
      	)
WHERE 
       	t.status = 'NOTSTART'
      	AND j.cseg_sna_revenue_st IN (263,18,19)
     	AND j.custentity_nx_project_type IN (4,5,6,7,8,12,13,14,15,10)
	AND t.startdate >= CURRENT_DATE - 1
	AND t.createddate >= CURRENT_DATE - 1
ORDER BY task_id ASC